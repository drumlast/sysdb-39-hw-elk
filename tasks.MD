‚úÖ –ó–∞–¥–∞–Ω–∏–µ 1: Elasticsearch
–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

sudo apt update
sudo apt install openjdk-11-jdk -y
wget https://mirror.yandex.ru/mirrors/elastic/8/pool/main/e/elasticsearch/elasticsearch-8.11.3-amd64.deb
sudo dpkg -i elasticsearch-8.11.3-amd64.deb

–ù–∞—Å—Ç—Ä–æ–π–∫–∞:

–û—Ç–∫—Ä—ã–≤–∞–µ–º —Ñ–∞–π–ª:

sudo nano /etc/elasticsearch/elasticsearch.yml

–î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—Ä–æ–∫—É (–∑–∞–º–µ–Ω–∏ random-cluster-name –Ω–∞ –ª—é–±–æ–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è):

cluster.name: random-cluster-name

–ó–∞–ø—É—Å–∫–∞–µ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º:

sudo systemctl enable elasticsearch
sudo systemctl start elasticsearch

–ü—Ä–æ–≤–µ—Ä–∫–∞:

curl -X GET 'localhost:9200/_cluster/health?pretty'

    üì∏ –°–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω, –≥–¥–µ –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ cluster_name : "random-cluster-name"

‚úÖ –ó–∞–¥–∞–Ω–∏–µ 2: Kibana
–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

wget https://mirror.yandex.ru/mirrors/elastic/8/pool/main/k/kibana/kibana-8.11.3-amd64.deb
sudo dpkg -i kibana-8.11.3-amd64.deb

–ù–∞—Å—Ç—Ä–æ–π–∫–∞:

sudo nano /etc/kibana/kibana.yml

–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å—Ç–æ–∏—Ç:

server.host: "0.0.0.0"

–ó–∞–ø—É—Å–∫:

sudo systemctl enable kibana
sudo systemctl start kibana

–ó–∞–π–¥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

http://<IP-—Å–µ—Ä–≤–µ—Ä–∞>:5601/app/dev_tools#/console

–ò –≤—ã–ø–æ–ª–Ω–∏:

GET /_cluster/health?pretty

    üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º Kibana –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –∑–∞–ø—Ä–æ—Å–∞

‚úÖ –ó–∞–¥–∞–Ω–∏–µ 3: Logstash + Nginx
–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

sudo apt install nginx -y
wget https://mirror.yandex.ru/mirrors/elastic/8/pool/main/l/logstash/logstash-8.11.3-amd64.deb
sudo dpkg -i logstash-8.11.3-amd64.deb

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Logstash:

–°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª:

sudo nano /etc/logstash/conf.d/nginx.conf

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:

input {
  file {
    path => "/var/log/nginx/access.log"
    start_position => "beginning"
  }
}

filter {
  grok {
    match => { "message" => "%{COMBINEDAPACHELOG}" }
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "nginx-access-log"
  }
}

–ó–∞–ø—É—Å–∫:

sudo systemctl enable logstash
sudo systemctl start logstash

    üì∏ –ó–∞–π–¥–∏ –≤ Kibana ‚Üí Discover, –∏ –Ω–∞–π–¥–∏ –∏–Ω–¥–µ–∫—Å nginx-access-log ‚Äî —Å–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω, –≥–¥–µ –≤–∏–¥–Ω—ã –ª–æ–≥–∏

‚úÖ –ó–∞–¥–∞–Ω–∏–µ 4: Filebeat
–£—Å—Ç–∞–Ω–æ–≤–∫–∞:

wget https://mirror.yandex.ru/mirrors/elastic/8/pool/main/f/filebeat/filebeat-8.11.3-amd64.deb
sudo dpkg -i filebeat-8.11.3-amd64.deb

–ù–∞—Å—Ç—Ä–æ–π–∫–∞:

sudo filebeat modules enable nginx
sudo filebeat setup

–ü—Ä–æ–≤–µ—Ä—å filebeat.yml:

sudo nano /etc/filebeat/filebeat.yml

–£–±–µ–¥–∏—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏:

output.elasticsearch:
  hosts: ["http://localhost:9200"]

–û—Ç–∫–ª—é—á–∏ Logstash (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è):

sudo systemctl stop logstash

–ó–∞–ø—É—Å–∫ Filebeat:

sudo systemctl enable filebeat
sudo systemctl start filebeat

    üì∏ –û—Ç–∫—Ä–æ–π Kibana ‚Üí Discover, —É–±–µ–¥–∏—Å—å —á—Ç–æ –ª–æ–≥–∏ –ø–æ—Å—Ç—É–ø–∞—é—Ç —á–µ—Ä–µ–∑ Filebeat

‚≠ê –ó–∞–¥–∞–Ω–∏–µ 5* (–ø–æ –∂–µ–ª–∞–Ω–∏—é): –õ–æ–≥–∏ –ª—é–±–æ–≥–æ –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
–ü—Ä–∏–º–µ—Ä:

–î–æ–ø—É—Å—Ç–∏–º, –±–µ—Ä—ë–º –ª–æ–≥-—Ñ–∞–π–ª myapp.log —Å–æ —Å–≤–æ–∏–º —Ñ–æ—Ä–º–∞—Ç–æ–º.

    –ù–∞—Å—Ç—Ä–æ–π Logstash –¥–ª—è —Ä–∞–∑–±–æ—Ä–∞ —ç—Ç–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JSON):

input {
  file {
    path => "/var/log/myapp.log"
    start_position => "beginning"
    codec => "json"
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "myapp-log"
  }
}

    –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Logstash:

sudo systemctl restart logstash

    –û—Ç–∫—Ä–æ–π Kibana ‚Üí Discover ‚Üí myapp-log

    üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç —Å –ª–æ–≥–∞–º–∏ –¥—Ä—É–≥–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —É–∫–∞–∂–∏ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ